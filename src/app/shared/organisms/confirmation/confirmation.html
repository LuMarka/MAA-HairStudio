<div class="purchase-order__content">
  <div class="container">
    @if (orderSent()) {
    <!-- Success Message -->
    <div class="success-container">
      <div class="success-content">
        <div class="success-icon">‚úÖ</div>
        <h2 class="success-title">¬°Gracias por tu compra!</h2>
        <p class="success-message">
          Tu pedido ha sido enviado correctamente. Nos pondremos en contacto contigo por WhatsApp muy pronto.
        </p>
        <div class="success-details">
          <div class="success-detail">
            <span class="success-detail__icon">üì±</span>
            <span class="success-detail__text">Mensaje enviado por WhatsApp</span>
          </div>
          <div class="success-detail">
            <span class="success-detail__icon">‚è∞</span>
            <span class="success-detail__text">Te contactaremos en las pr√≥ximas horas</span>
          </div>
          <div class="success-detail">
            <span class="success-detail__icon">üöö</span>
            <span class="success-detail__text">{{ deliveryOptionText() }}</span>
          </div>
        </div>
        <div class="success-actions">
          <button type="button" class="btn btn--primary" (click)="onBackToHome()">
            <span class="btn__icon">üè†</span>
            <span class="btn__text">Volver al Inicio</span>
          </button>
        </div>
        <p class="success-redirect">Ser√°s redirigido autom√°ticamente en 5 segundos...</p>
      </div>
    </div>
    } @else {
    <!-- Order Confirmation -->
    <div class="confirmation-container">
      <div class="confirmation-header">
        <h2 class="confirmation-header__title">Confirmar Pedido</h2>
        <p class="confirmation-header__subtitle">Revisa los detalles antes de finalizar tu compra</p>

        <div class="success-indicator">
          <span class="success-indicator__icon">‚úÖ</span>
          <span>Informaci√≥n verificada y lista para procesar</span>
        </div>
      </div>

      <!-- Content Grid -->
      <div class="confirmation-content">
        <!-- Customer Information -->
        <div class="confirmation-section">
          <div class="confirmation-section__header">
            <div class="confirmation-section__icon">üë§</div>
            <h3 class="confirmation-section__title">Informaci√≥n del Cliente</h3>
          </div>

          @if (orderData(); as data) {
          <div class="confirmation-section__content">
            <div class="confirmation-item">
              <span class="confirmation-item__label">Cliente:</span>
              <span class="confirmation-item__value">{{ data.firstName }} {{ data.lastName }}</span>
            </div>
            <div class="confirmation-item">
              <span class="confirmation-item__label">Email:</span>
              <span class="confirmation-item__value">{{ data.email }}</span>
            </div>
            <div class="confirmation-item">
              <span class="confirmation-item__label">Tel√©fono:</span>
              <span class="confirmation-item__value">{{ data.phone }}</span>
            </div>

            @if (data.deliveryOption === 'delivery') {
            <div class="confirmation-item confirmation-item--address">
              <span class="confirmation-item__label">Direcci√≥n:</span>
              <div class="confirmation-item__value">
                <div>{{ data.address }}</div>
                <div>{{ data.city }}@if (data.postalCode) { ({{ data.postalCode }}) }</div>
              </div>
            </div>
            } @else {
            <div class="confirmation-item">
              <span class="confirmation-item__label">Modalidad:</span>
              <span class="confirmation-item__value">Retiro en tienda</span>
            </div>
            }

            @if (data.notes) {
            <div class="confirmation-item confirmation-item--notes">
              <span class="confirmation-item__label">Notas:</span>
              <span class="confirmation-item__value">{{ data.notes }}</span>
            </div>
            }
          </div>

          <!-- Payment Method Badge -->
          @if (selectedPaymentMethod()) {
          <div class="payment-method-badge">
            <div class="payment-method-badge__icon">üí≥</div>
            <div class="payment-method-badge__content">
              <span class="payment-method-badge__label">M√©todo de pago</span>
              <span class="payment-method-badge__value">{{ selectedPaymentMethodText() }}</span>
            </div>
          </div>
          }
          }
        </div>

        <!-- Order Summary -->
        <div class="confirmation-section">
          <div class="confirmation-section__header">
            <div class="confirmation-section__icon">üõí</div>
            <h3 class="confirmation-section__title">Resumen del Pedido</h3>
          </div>

          <div class="confirmation-section__content">
            <div class="order-items-list">
              <!-- @for (item of cartItems(); track item.id) {
                      <div class="order-item-card">
                        <div class="order-item-card__info">
                          <h4 class="order-item-card__name">{{ item.name }}</h4>
                          @if (item.brand) {
                            <span class="order-item-card__brand">{{ item.brand }}</span>
                          }
                        </div>
                        <div class="order-item-card__quantity">x{{ item.quantity }}</div>
                        <div class="order-item-card__price">${{ (item.price * item.quantity).toFixed(2) }}</div>
                      </div>
                    } -->
            </div>

            <!-- Order totals -->
            <div class="confirmation-item">
              <span class="confirmation-item__label">Subtotal:</span>
              <!-- <span class="confirmation-item__value">${{ subtotal().toFixed(2) }}</span> -->
            </div>
            <div class="confirmation-item">
              <span class="confirmation-item__label">Env√≠o:</span>
              <span class="confirmation-item__value">
                @if (selectedDeliveryOption() === 'pickup') {
                Gratis
                } @else {
                A convenir
                }
              </span>
            </div>
            <div class="confirmation-item">
              <span class="confirmation-item__label">IVA (21%):</span>
              <!-- <span class="confirmation-item__value">${{ ivaAmount().toFixed(2) }}</span> -->
            </div>
            <div class="confirmation-item confirmation-item--total">
              <span class="confirmation-item__label">Total:</span>
              <!-- <span class="confirmation-item__value">${{ totalWithIva().toFixed(2) }}</span> -->
            </div>
          </div>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="confirmation-actions">
        <div class="confirmation-actions__secondary">
          <button type="button" class="btn btn--outline" (click)="onEditCart()">
            <span class="btn__icon">üõí</span>
            <span class="btn__text">Editar Carrito</span>
          </button>

          <button type="button" class="btn btn--secondary" (click)="onPreviousStep()">
            <span class="btn__icon">‚Üê</span>
            <span class="btn__text">Volver</span>
          </button>
        </div>

        <div class="confirmation-actions__primary">
          <button type="button" class="btn btn--primary btn--large" [class.btn--loading]="isProcessing()"
            [disabled]="isProcessing()" (click)="onFinalizeOrder()">
            @if (isProcessing()) {
            <span class="btn__text">Procesando...</span>
            } @else {
            <span class="btn__text">Finalizar Pedido</span>
            <span class="btn__icon">‚úÖ</span>
            }
          </button>
        </div>
      </div>
    </div>
    }
  </div>
</div>