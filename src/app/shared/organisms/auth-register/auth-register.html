
<section class="auth auth--register">
	<div class="auth__card">
		<h1 class="auth__title">Crear cuenta</h1>
		@if (successMessage()) {
			<div class="auth__success">
				{{ successMessage() }}
				<div class="auth__actions">
					<a (click)="onLoginClick()" class="auth__link">Ir a iniciar sesi√≥n</a>
				</div>
			</div>
		} @else {
			<form [formGroup]="form" (ngSubmit)="submit()" class="auth__form">
				<div class="auth__form-group">
					<label class="auth__label" for="name">Nombre completo</label>
					<input
						id="name"
						type="text"
						formControlName="name"
						class="auth__input"
						[class.auth__input--error]="form.get('name')?.touched && form.get('name')?.invalid"
						placeholder="Tu nombre completo"
					/>
					@if (form.get('name')?.touched && form.get('name')?.invalid) {
						<p class="auth__error">El nombre es requerido.</p>
					}
				</div>

				<div class="auth__form-group">
					<label class="auth__label" for="email">Correo electr√≥nico</label>
					<input
						id="email"
						type="email"
						formControlName="email"
						class="auth__input"
						[class.auth__input--error]="form.get('email')?.touched && form.get('email')?.invalid"
						placeholder="ejemplo@correo.com"
					/>
					@if (form.get('email')?.touched && form.get('email')?.invalid) {
						<p class="auth__error">
							@if (form.get('email')?.errors?.['required']) {
								<span>El correo es requerido.</span>
							}
							@if (form.get('email')?.errors?.['email']) {
								<span>Ingresa un correo v√°lido.</span>
							}
						</p>
					}
				</div>

				<div class="auth__form-group">
					<label class="auth__label" for="password">Contrase√±a</label>
					<div class="auth__password-wrapper">
						<input
							id="password"
							[type]="passwordVisible() ? 'text' : 'password'"
							formControlName="password"
							class="auth__input"
							[class.auth__input--error]="form.get('password')?.touched && form.get('password')?.invalid"
							placeholder="Al menos 6 caracteres"
						/>
						<button type="button" class="auth__toggle" (click)="togglePasswordVisibility('password')">üëÅÔ∏è</button>
					</div>
					@if (form.get('password')?.touched && form.get('password')?.invalid) {
						<p class="auth__error">
							@if (form.get('password')?.errors?.['required']) {
								<span>La contrase√±a es requerida.</span>
							}
							@if (form.get('password')?.errors?.['minlength']) {
								<span>M√≠nimo 6 caracteres.</span>
							}
						</p>
					}
				</div>

				<div class="auth__form-group">
					<label class="auth__label" for="confirm">Confirmar contrase√±a</label>
					<div class="auth__password-wrapper">
						<input
							id="confirm"
							[type]="confirmPasswordVisible() ? 'text' : 'password'"
							formControlName="confirm"
							class="auth__input"
							[class.auth__input--error]="form.get('confirm')?.touched && form.get('confirm')?.invalid || form.errors?.['passwordMismatch']"
							placeholder="Confirma tu contrase√±a"
						/>
						<button type="button" class="auth__toggle" (click)="togglePasswordVisibility('confirm')">üëÅÔ∏è</button>
					</div>
					@if (form.get('confirm')?.touched && form.get('confirm')?.invalid) {
						<p class="auth__error">
							@if (form.get('confirm')?.errors?.['required']) {
								<span>Confirma tu contrase√±a.</span>
							}
						</p>
					}
					@if (form.errors?.['passwordMismatch'] && form.get('confirm')?.touched) {
						<p class="auth__error">Las contrase√±as no coinciden.</p>
					}
				</div>

				@if (error()) {
					<p class="auth__server-error">{{ error() }}</p>
				}

				<button class="auth__btn auth__btn--primary" type="submit" [disabled]="loading() || form.invalid">
					{{ loading() ? 'Procesando...' : 'Registrarse' }}
				</button>

				<p class="auth__footer">¬øYa tienes una cuenta? <a (click)="onLoginClick()">Inicia sesi√≥n</a></p>
			</form>
		}
	</div>
</section>
