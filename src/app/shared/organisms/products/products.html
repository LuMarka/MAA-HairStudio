<div class="products-container">
  <!-- Filtro horizontal por tipo que se muestra primero en mobile/tablet -->
  <!--  <nav class="products-type-filter" aria-label="Filtrar por tipo">
    @for (t of productTypes; track t.value) {
      <button
        class="products-type-filter__btn"
        [class.products-type-filter__btn--active]="selectedType === t.value"
        (click)="selectType(t.value)"
        type="button"
        [attr.aria-pressed]="selectedType === t.value"
      >
        @if (t.image) {
          <span class="products-type-filter__icon">
            <img [src]="t.image" [alt]="t.label" />
          </span>
        }
        <span class="products-type-filter__label">{{ t.label }}</span>
      </button>
    }
  </nav> -->

  <!-- Filtro lateral que se muestra segundo en mobile/tablet -->
  <aside class="products-filter">
    <div class="products-filter__group">
      <label for="category-desktop">Marca</label>
      <select id="category-desktop" name="category" [value]="selectedCategory()" [disabled]="isLoadingCategories()"
        (change)="onCategoryChange($any($event.target).value)">
        @for (option of categoryOptions(); track option.value) {
        <option [value]="option.value">{{ option.label }}</option>
        }
      </select>
      @if (isLoadingCategories()) {
      <small class="loading-text">Cargando categorías...</small>
      }
      @if (categoryError()) {
      <small class="error-text">{{ categoryError() }}</small>
      }
    </div>
    @if (shouldShowSubCategorySelect()) {
    <div class="products-filter__group">
      <label for="collection">Colección</label>
      <select id="collection" name="collection" [value]="selectedSubCategory()" [disabled]="isLoadingSubCategories()"
        (change)="onSubCategoryChange($any($event.target).value)">
        @for (option of subCategoryOptions(); track option.value) {
        <option [value]="option.value" [disabled]="option.disabled">
          {{ option.label }}
        </option>
        }
      </select>
      @if (isLoadingSubCategories()) {
      <small class="loading-text">Cargando subcategorías...</small>
      }
      @if (subCategoryError()) {
      <small class="error-text">{{ subCategoryError() }}</small>
      }
      @if (!hasSubCategoriesAvailable() && !isLoadingSubCategories()) {
      <small class="info-text">No hay subcategorías disponibles</small>
      }
    </div>
    }
    <!--<div class="products-filter__group">
      <label for="sort">Ordenar por</label>
      <select #sortSelect id="sort" name="sort" [(ngModel)]="selectedSort" (change)="onSortChange(sortSelect.value)">
        <option *ngFor="let opt of sortOptions" [value]="opt.value">{{ opt.label }}</option>
      </select>
    </div>-->
  </aside>

  <div class="products-layout">
    <!-- Filtro lateral para desktop -->
    <aside class="products-filter products-filter--desktop">
      <div class="products-filter__group">
        <label for="category-desktop">Marca</label>
        <select id="category-desktop" name="category" [value]="selectedCategory()" [disabled]="isLoadingCategories()"
          (change)="onCategoryChange($any($event.target).value)">
          @for (option of categoryOptions(); track option.value) {
          <option [value]="option.value">{{ option.label }}</option>
          }
        </select>
        @if (isLoadingCategories()) {
        <small class="loading-text">Cargando categorías...</small>
        }
        @if (categoryError()) {
        <small class="error-text">{{ categoryError() }}</small>
        }
      </div>
      @if (shouldShowSubCategorySelect()) {
      <div class="products-filter__group">
        <label for="collection-desktop">Colección</label>
        <select id="collection-desktop" name="collection" [value]="selectedSubCategory()"
          [disabled]="isLoadingSubCategories()" (change)="onSubCategoryChange($any($event.target).value)">
          @for (option of subCategoryOptions(); track option.value) {
          <option [value]="option.value" [disabled]="option.disabled">
            {{ option.label }}
          </option>
          }
        </select>
        @if (isLoadingSubCategories()) {
        <small class="loading-text">Cargando subcategorías...</small>
        }
        @if (subCategoryError()) {
        <small class="error-text">{{ subCategoryError() }}</small>
        }
        @if (!hasSubCategoriesAvailable() && !isLoadingSubCategories()) {
        <small class="info-text">No hay subcategorías disponibles</small>
        }
      </div>
      }
      <!--<div class="products-filter__group">
        <label for="sort-desktop">Ordenar por</label>
        <select #sortSelectDesktop id="sort-desktop" name="sort" [(ngModel)]="selectedSort" (change)="onSortChange(sortSelectDesktop.value)">
          <option *ngFor="let opt of sortOptions" [value]="opt.value">{{ opt.label }}</option>
        </select>
      </div>-->
    </aside>

    <div class="products-main">
      <!-- Filtro horizontal por tipo (mostrado solo en desktop) -->
      <!-- <nav class="products-type-filter products-type-filter--desktop" aria-label="Filtrar por tipo">
        @for (t of dataApi()?.data; track t.id) {
          <button
            class="products-type-filter__btn"
            [class.products-type-filter__btn--active]="selectedType === t.value"
            (click)="selectType(t.value)"
            type="button"
            [attr.aria-pressed]="selectedType === t.value"
          >
            @if (t.image) {
              <span class="products-type-filter__icon">
                <img [src]="t.image" [alt]="t.label" />
              </span>
            }
            <span class="products-type-filter__label">{{ t.label }}</span>
          </button>
        }
      </nav> -->

      <div class="products-brand-sections">
        <section class="products__brand-group">
          <h2 class="products__brand-title">{{ 'luisa' }}</h2>
          <div class="products">
            @for (product of dataApi()?.data; track product.id) {
            <app-product-card [product]="product"></app-product-card>
            }
          </div>
          <!-- Paginador -->
          @if (dataApi()?.meta) {
          <app-paginator [meta]="dataApi()!.meta" entityName="productos" [showPageSizeSelector]="true"
            (pageChange)="onPageChange($event)" />
          }
        </section>
      </div>
    </div>
  </div>
</div>
