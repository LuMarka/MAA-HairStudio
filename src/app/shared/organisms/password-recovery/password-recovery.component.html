<div class="password-recovery">
  @if (state() === 'FORM') {
  <div class="password-recovery__container">
    <div class="password-recovery__header">
      <h2 class="password-recovery__title">Recuperar Contraseña</h2>
      <p class="password-recovery__description">
        Ingresa el correo electrónico asociado a tu cuenta. Te enviaremos un
        enlace para restablecer tu contraseña.
      </p>
    </div>

    <div
      role="form"
      [formGroup]="recoveryForm"
      class="password-recovery__form"
      (keydown.enter)="onSubmit()"
    >
      <div class="password-recovery__form-group">
        <label for="pr-email" class="password-recovery__label">Correo electrónico</label>
        <input
          id="pr-email"
          type="email"
          formControlName="email"
          class="password-recovery__input"
          placeholder="tu@email.com"
          [class.password-recovery__input--error]="emailError()"
          [attr.aria-invalid]="!!emailError()"
          [attr.aria-describedby]="emailError() ? 'pr-email-error' : null"
        />
        @if (emailError()) {
        <span id="pr-email-error" class="password-recovery__error">
          {{ emailError() }}
        </span>
        }
      </div>

      @if (error()) {
      <div class="password-recovery__alert password-recovery__alert--error">
        {{ error() }}
      </div>
      }

      <button
        type="button"
        class="password-recovery__button"
        (click)="onSubmit()"
        [disabled]="!isFormValid()"
        [attr.aria-busy]="loading()"
      >
        @if (loading()) {
        <span class="password-recovery__spinner" aria-hidden="false"></span>
        <span>Enviando...</span>
        } @else {
        <span>Enviar Enlace de Recuperación</span>
        }
      </button>
    </div>

    <div class="password-recovery__footer">
      <button
        type="button"
        class="password-recovery__link"
        (click)="onBackToLogin()"
        [disabled]="loading()"
      >
        ← Volver al inicio de sesión
      </button>
    </div>
  </div>
  } @else if (state() === 'SUCCESS') {
  <div class="password-recovery__container password-recovery__container--success">
    <div class="password-recovery__success-icon" aria-hidden="true">
      <svg width="56" height="56" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="32" cy="32" r="30" stroke="currentColor" stroke-width="2" />
        <path d="M24 32L30 38L42 26" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
      </svg>
    </div>

    <div class="password-recovery__success-content">
      <h3 class="password-recovery__success-title">¡Correo Enviado!</h3>
      <p class="password-recovery__success-message">
        Si la dirección de correo electrónico
        <strong>{{ successEmailValue() }}</strong>
        se encuentra en nuestro sistema, recibirás un email con instrucciones
        para restablecer tu contraseña en los próximos minutos. Por favor,
        revisa también tu carpeta de spam.
      </p>
    </div>

    <button
      type="button"
      class="password-recovery__button"
      (click)="onBackToLogin()"
    >
      Volver al inicio de sesión
    </button>
  </div>
  }
  HOLA
</div>