 @use '../../../../assets/styles/variables' as v;
@use '../../../../assets/styles/mixins' as m;

@keyframes scroll {
  from {
    transform: translateX(0);
  }
  to {
    // Mueve el contenedor exactamente la mitad de su ancho (un set de imágenes)
    transform: translateX(-50%);
  }
}

:host {
  display: block;
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
}

.gallery {
  display: flex;
  flex-direction: column;
  gap: v.$spacing-md;

  &__main-container {
    position: relative;
    width: 95%;
    margin: 0 auto;
    aspect-ratio: 4 / 3;
    border-radius: v.$borderRadius;
    overflow: hidden;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
  }

  &__main-image {
    width: 100%;
    height: 100%;
    object-fit: contain;
    display: block; // Evita espacios extra debajo de la imagen
  }

  &__nav {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 35px;
    height: 35px;
    border-radius: 50%;
    border: none;
    background: rgba(255, 255, 255, 0.9);
    color: v.color('primary');
    font-size: 1.2rem;
    cursor: pointer;
    transition: all 0.2s ease;
    z-index: 1;

    &:hover {
      background: v.color('primary');
      color: v.color('white1');
    }

    &--prev {
      left: v.$spacing-sm;
    }

    &--next {
      right: v.$spacing-sm;
    }
  }

  &__counter {
    position: absolute;
    top: v.$spacing-sm;
    right: v.$spacing-sm;
    background: rgba(0, 0, 0, 0.6);
    color: v.color('white1');
    padding: 3px 8px;
    border-radius: v.$borderRadius;
    font-size: 0.75rem;
  }

  &__caption {
    text-align: center;
    color: v.color('gray5');
    font-size: 0.9rem;
    padding: v.$spacing-xs 0;
  }

  &__thumbnails {
    width: 100%;
    overflow-x: auto; // Permite scroll manual en móvil/tablet
    scrollbar-width: none; // Oculta scrollbar

    &::-webkit-scrollbar {
      display: none;
    }

    -webkit-mask-image: linear-gradient(
      to right,
      transparent,
      black 10%,
      black 90%,
      transparent
    );
    mask-image: linear-gradient(
      to right,
      transparent,
      black 10%,
      black 90%,
      transparent
    );
  }

  &__thumbnails-track {
    // Solución definitiva: inline-flex evita el salto de línea.
    display: inline-flex;
    gap: v.$spacing-sm;
    padding: 4px 0; // Espacio para el borde de la imagen activa

    &--paused {
      animation-play-state: paused;
    }
  }

  &__thumbnail {
    flex-shrink: 0;
    width: 60px;
    aspect-ratio: 4 / 3;
    border: 3px solid transparent;
    border-radius: v.$borderRadius-sm;
    padding: 0;
    background: none;
    cursor: pointer;
    transition: border-color 0.2s ease;
    overflow: hidden;

    // Estilos móviles específicos
    @include m.mobile-only {
      width: 50px;
      border-width: 2px;
    }

    &--active {
      border-color: v.color('accent');
    }
  }

  &__thumbnail-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block; // Evita espacios extra debajo de la imagen
  }
}

// Media Queries
@include m.tablet-up {
  .gallery {
    &__main-container {
      aspect-ratio: 16 / 9;
      width: 90%;
    }

    &__main-image {
      object-fit: cover;
    }

    &__thumbnail {
      width: 70px;
      border-width: 3px;
    }

    &__thumbnails-track {
      gap: v.$spacing-md;
    }
  }
}

@include m.desktop-up {
  .gallery {
    &__main-container {
      width: 85%;
    }

    &__thumbnail {
      width: 80px;
    }

    &__thumbnails {
      overflow: hidden; // Oculta el scrollbar en desktop
    }

    &__thumbnails-track {
      // Activa la animación solo en desktop
      animation: scroll 40s linear infinite;
    }
  }
}


